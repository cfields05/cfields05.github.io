<!DOCTYPE html>
<html>

<head>
    <title>Wizard Clicker</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <h1>Wizard Clicker</h1>
    <!-- <div class="top-box"> -->
    <div class="main-box">
        <div class="clicker-box">
            <img src="/projects/clicker-chaos/images/orb.png" id="clicker-image">
            <p id="mana-amount">Mana Generated: 0 points</p>
            <p id="mana-per-second">Mana Generated per Second: 0 points</p>
        </div>

        <div class="autoclicker-box">
            <div class="autoclicker" id="autoclicker1" title="One point of mana generated per second!">
                <p>Black Cat</p>
                <p id="cat-count">Owned: 0</p>
                <p id="cat-cost">Cost: 50 mana</p>
                <button id="purchase-cat">BUY ONE</button>
            </div>

            <div class="autoclicker" id="autoclicker2" title="Ten points of mana generated per second!">
                <p>Magic Wand</p>
                <p id="wand-count">Owned: 0</p>
                <p id="wand-cost">Cost: 200 mana</p>
                <button id="purchase-wand">BUY ONE</button>
            </div>
            <div class="autoclicker" id="autoclicker3" title="Twenty-five points of mana generated per second!">
                <p>Magic Staff</p>
                <p id="staff-count">Owned: 0</p>
                <p id="staff-cost">Cost: 500 mana</p>
                <button id="purchase-staff">BUY ONE</button>
            </div>

            <div class="autoclicker" id="autoclicker4" title="Fifty points of mana generated per second!">
                <p>Magic Broomstick</p>
                <p id="broom-count">Owned: 0</p>
                <p id="broom-cost">Cost: 1000 mana</p>
                <button id="purchase-broom">BUY ONE</button>
            </div>

            <div class="autoclicker" id="autoclicker5" title="One hundred points of mana generated per second!">
                <p>Magic Spellbook</p>
                <p id="book-count">Owned: 0</p>
                <p id="book-cost">Cost: 1600 mana</p>
                <button id="purchase-book">BUY ONE</button>
            </div>

            <div class="autoclicker" id="autoclicker6" title="Two hundred points of mana generated per second!">
                <p>Super Cool Wizard Hat</p>
                <p id="hat-count">Owned: 0</p>
                <p id="hat-cost">Cost: 2500 mana</p>
                <button id="purchase-hat">BUY ONE</button>
            </div>
        </div>

        <!-- <div class="upgrade-box">

        </div> -->
    </div>
    <div class="news-box">
        <div class="inner-box">
            <p id="text">Breaking News: Insert Fun Facts Here</p>
        </div>
    </div>
    <!-- <div class="credits">

            </div> -->
    <!-- </div> -->
    <script>
        // Variables
        var mana = 0;
        var manaPerSecond = 0;

        // news array holds messages to display in the news box
        // TODO: CHANGE NEWS STRINGS TO FUNCTIONS FOR MODULAR MESSAGES
        // Template literals (google)
        // Add syntax highlighter extension
        const news = [
            "Prices of cursed crystals skyrocketing!",
            "Mass recall of magic runes due to spontaneous combustion!",
            "Local wizard declares computers objectively inferior to magic!",
            "“Bippity Boppity Boo,” claims local crazy woman!"
        ];

        // “” quotation marks (for copying later)

        // Each autoclicker obj stores a mana per second value, the amount owned (starting at 0), and the base cost of the item, as well as the ids for the count and cost elements
        // Black Cats generate 1 mana per second and base price is 50 points of mana
        const blackCat = createAutoclicker(1, 50, "#cat-count", "#cat-cost");

        // Magic Wands generate 10 mana per second and base price is 200 points of mana
        const magicWand = createAutoclicker(10, 200, "#wand-count", "#wand-cost");

        // Magic Staves generate 25 mana per second and base price is 500 points of mana
        const magicStaff = createAutoclicker(25, 500, "#staff-count", "#staff-cost");

        // Magic Broomsticks generate 50 mana per second and base price is 1000 points of mana
        const magicBroomstick = createAutoclicker(50, 1000, "#broom-count", "#broom-cost");

        // Magic Spellbooks generate 100 mana per second and base price is 1600 points of mana
        const magicSpellbook = createAutoclicker(100, 1600, "#book-count", "#book-cost");

        // Super Cool Wizard Hats generate 200 mana per second and base price is 2500 points of mana
        const wizardHat = createAutoclicker(200, 2500, "#hat-count", "#hat-cost");


        // Core Functionality
        newsMessage();
        setInterval(newsMessage, 10_000);
        setInterval(addAutoMana, 1_000);

        // Event/Click Listeners
        // ADD FUNCTION TO HANDLE CLICKING ANY BUTTON FOR PURCHASE
        $("#clicker-image").on("click", generateMana);
        $("#purchase-cat").on("click", {obj: blackCat}, purchase);
        $("#purchase-wand").on("click", {obj: magicWand}, purchase);
        $("#purchase-staff").on("click", {obj: magicStaff}, purchase);
        $("#purchase-broom").on("click", {obj: magicBroomstick}, purchase);
        $("#purchase-book").on("click", {obj: magicSpellbook}, purchase);
        $("#purchase-hat").on("click", {obj: wizardHat}, purchase);

        // Functions
        // Factory function to automatically create an autoclicker object
        function createAutoclicker(mps, baseCost, countId, costId) {
            return {
                mps: mps,
                numberOwned: 0,
                baseCost: baseCost,
                countId: countId,
                costId: costId,
            };
        }

        // Increases mana and updates text when orb is clicked
        function generateMana() {
            mana++;
            $("#mana-amount").text("Mana Generated: " + Math.floor(mana) + " points");
        }

        // Purchases any item passed in, increasing the cost of that item and the mana per second of the player
        function purchase(item) {
            item = item.data.obj;
            const cost = Math.ceil(item.baseCost * Math.pow(1.1, item.numberOwned));

            if (mana >= cost) {
                mana -= cost;
                manaPerSecond += item.mps;
                item.numberOwned++;

                $("#mana-amount").text("Mana Generated: " + Math.floor(mana) + " points");
                $("#mana-per-second").text("Mana Generated per Second: " + manaPerSecond + " points");
                $(item.countId).text("Owned: " + item.numberOwned);
            }

            const newCost = Math.ceil(
                item.baseCost * Math.pow(1.1, item.numberOwned)
            );
            $(item.costId).text("Cost: " + newCost + " mana");
        }

        // Handles automatically increasing your mana
        function addAutoMana() {
            mana += manaPerSecond;
            $("#mana-amount").text("Mana Generated: " + Math.floor(mana) + " points");
        }

        // Randomly chooses one of the news messages and displays them
        function newsMessage() {
            const message = Math.floor(Math.random() * news.length);
            // Fade out animation
            $('#text').finish().fadeTo(300, 0, function () {
                // Update text
                $("#text").text("Breaking News: " + news[message]);
                // Fade back in again
                $('#text').finish().fadeTo(300, 1);
            });
        }

        /* All code above here */
    </script>
</body>

</html>